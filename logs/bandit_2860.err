+++ dirname /opt/slurm/data/slurmd/job02860/slurm_script
++ cd /opt/slurm/data/slurmd/job02860
++ pwd
+ SCRIPT_DIR=/opt/slurm/data/slurmd/job02860
+ SUBMIT_DIR=/home/dk5268/decision-pretrained-transformer
+ '[' -f /home/dk5268/decision-pretrained-transformer/collect_data.py ']'
+ '[' -f /home/dk5268/decision-pretrained-transformer/train.py ']'
+ PROJECT_ROOT=/home/dk5268/decision-pretrained-transformer
+ cd /home/dk5268/decision-pretrained-transformer
+ export PYTHONPATH=/home/dk5268/decision-pretrained-transformer:
+ PYTHONPATH=/home/dk5268/decision-pretrained-transformer:
+ mkdir -p logs
+ export CUDA_VISIBLE_DEVICES=0
+ CUDA_VISIBLE_DEVICES=0
+ echo 'Starting bandit training job'
+ echo 'Project root: /home/dk5268/decision-pretrained-transformer'
++ pwd
+ echo 'Working directory: /home/dk5268/decision-pretrained-transformer'
+ echo 'CUDA devices: 0'
+ echo 'Collecting data...'
+ python3 collect_data.py --env bandit --envs 100000 --H 500 --dim 5 --var 0.3 --cov 0.0 --envs_eval 200
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
+ echo 'Training model...'
+ python3 train.py --env bandit --envs 100000 --H 500 --dim 5 --var 0.3 --cov 0.0 --lr 0.0001 --layer 4 --head 4 --shuffle --seed 1
+ echo 'Evaluating model...'
+ python3 eval.py --env bandit --envs 100000 --H 500 --dim 5 --var 0.3 --cov 0.0 --lr 0.0001 --layer 4 --head 4 --shuffle --epoch 400 --n_eval 200 --seed 1
Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
/home/dk5268/miniconda3/envs/dpt/lib/python3.9/site-packages/packaging/version.py:111: DeprecationWarning: Creating a LegacyVersion has been deprecated and will be removed in the next major release
  warnings.warn(
+ echo 'Bandit training job completed!'
